{"version":3,"sources":["features/ManageRequest/slice.js","api/requests.js"],"names":["initialState","blockIds","data","pageSize","totalPage","currentPage","sortOrder","sortBy","showModal","lstServer","requestDetail","requestLogs","filterKeys","slice","createSlice","name","reducers","setFilter","state","action","payload","setData","setPagination","setSortTable","setCurrentPage","setPageSize","setModal","setListServer","setRequestDetail","actions","getListRequests","params","dispatch","Promise","resolve","reject","getListRequestApi","then","res","CurrentPage","TotalPage","catch","error","onCreateNewRequest","loading","createRequestApi","message","success","pageNumber","sortColumn","keyword","response","finally","stopLoading","getListServerOptions","getServerOptionsApi","getListUserOptions","getListUserOptionsApi","approveRequest","value","approveRequestApi","getRequestDetail","requestId","cancelRequest","cancelRequestApi","getRequestDetailApi","detail","logs","onUpdateRequest","updateRequestApi","exportRequestByServer","val","exportRequestApi","axios","get","post","put","getAllMessageApi"],"mappings":"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","file":"static/js/16.91dfa913.chunk.js","sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\r\nimport { loading, stopLoading } from \"features/App/slice\";\r\nimport {\r\n  getListRequestApi,\r\n  createRequestApi,\r\n  getServerOptionsApi,\r\n  approveRequestApi,\r\n  cancelRequestApi,\r\n  getRequestDetailApi,\r\n  updateRequestApi,\r\n  getListUserOptionsApi,\r\n  exportRequestApi,\r\n} from \"api/requests\";\r\nimport { message } from \"antd\";\r\n\r\nexport const initialState = {\r\n  blockIds: null,\r\n  data: [],\r\n  pageSize: 10,\r\n  totalPage: 1,\r\n  currentPage: 1,\r\n  sortOrder: \"descend\",\r\n  sortBy: \"\",\r\n  showModal: false,\r\n  lstServer: [],\r\n  requestDetail: {},\r\n  requestLogs: [],\r\n  filterKeys: \"\",\r\n};\r\n\r\nconst slice = createSlice({\r\n  name: \"requestManagement\",\r\n  initialState,\r\n  reducers: {\r\n    setFilter: (state, action) => {\r\n      state.blockIds = action.payload.blockIds;\r\n    },\r\n    setData: (state, action) => {\r\n      state.data = action.payload.data;\r\n    },\r\n    setPagination: (state, action) => {\r\n      state.currentPage = action.payload.currentPage;\r\n      state.pageSize = action.payload.pageSize;\r\n      state.totalPage = action.payload.totalPage;\r\n    },\r\n    setSortTable: (state, action) => {\r\n      state.sortBy = action.payload.sortBy;\r\n      state.sortOrder = action.payload.sortOrder;\r\n      state.filterKeys = action.payload.filterKeys;\r\n    },\r\n    setCurrentPage: (state, action) => {\r\n      state.currentPage = action.payload.currentPage;\r\n    },\r\n    setPageSize: (state, action) => {\r\n      state.pageSize = action.payload.pageSize;\r\n      state.currentPage = 1;\r\n    },\r\n    setModal: (state, action) => {\r\n      state.showModal = action.payload.showModal;\r\n    },\r\n    setListServer: (state, action) => {\r\n      state.lstServer = action.payload.lstServer;\r\n    },\r\n    setRequestDetail: (state, action) => {\r\n      state.requestDetail = action.payload.requestDetail;\r\n      state.requestLogs = action.payload.requestLogs;\r\n    },\r\n  },\r\n});\r\n\r\nexport const {\r\n  setFilter,\r\n  setData,\r\n  setPagination,\r\n  setSortTable,\r\n  setCurrentPage,\r\n  setPageSize,\r\n  setModal,\r\n  setListServer,\r\n  setRequestDetail,\r\n} = slice.actions;\r\nexport default slice.reducer;\r\n\r\nexport const getListRequests = (params = {}) => (dispatch) => {\r\n  return new Promise((resolve, reject) => {\r\n    return getListRequestApi(params)\r\n      .then((res) => {\r\n        dispatch(\r\n          setPagination({\r\n            currentPage: res.CurrentPage,\r\n            pageSize: params.pageSize,\r\n            totalPage: res.TotalPage,\r\n          })\r\n        );\r\n        dispatch(setData({ data: res.data }));\r\n        resolve();\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const onCreateNewRequest = (data = {}) => (dispatch) => {\r\n  return new Promise((resolve, reject) => {\r\n    dispatch(loading());\r\n    return createRequestApi(data)\r\n      .then((res) => {\r\n        message.success(\"success\");\r\n        dispatch(setModal({ showModal: false }));\r\n        dispatch(\r\n          getListRequests({\r\n            pageSize: initialState.pageSize,\r\n            pageNumber: initialState.currentPage,\r\n            sortColumn: initialState.sortBy,\r\n            sortOrder: initialState.sortOrder,\r\n            keyword: \"\",\r\n          })\r\n        );\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        message.error(error.response.data.message);\r\n        reject(error);\r\n      })\r\n      .finally(() => {\r\n        dispatch(stopLoading());\r\n      });\r\n  });\r\n};\r\n\r\nexport const getListServerOptions = () => (dispatch) => {\r\n  return new Promise((resolve, reject) => {\r\n    return getServerOptionsApi()\r\n      .then((res) => {\r\n        dispatch(setListServer({ lstServer: res.data.data }));\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const getListUserOptions = () => {\r\n  return new Promise((resolve, reject) => {\r\n    return getListUserOptionsApi()\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const approveRequest = (value) => (dispatch) => {\r\n  return new Promise((resolve, reject) => {\r\n    dispatch(loading());\r\n    return approveRequestApi(value)\r\n      .then((res) => {\r\n        message.success(\"success\");\r\n        dispatch(getRequestDetail(value.requestId));\r\n        resolve();\r\n      })\r\n      .catch((error) => {\r\n        message.error(error.response.data.message);\r\n        reject(error);\r\n      })\r\n      .finally(() => {\r\n        dispatch(stopLoading());\r\n      });\r\n  });\r\n};\r\n\r\nexport const cancelRequest = (value) => (dispatch) => {\r\n  return new Promise((resolve, reject) => {\r\n    dispatch(loading());\r\n    return cancelRequestApi(value)\r\n      .then((res) => {\r\n        message.success(\"success\");\r\n        dispatch(getRequestDetail(value.requestId));\r\n        resolve();\r\n      })\r\n      .catch((error) => {\r\n        message.error(error.response.data.message);\r\n        reject(error);\r\n      })\r\n      .finally(() => {\r\n        dispatch(stopLoading());\r\n      });\r\n  });\r\n};\r\n\r\nexport const getRequestDetail = (value) => (dispatch) => {\r\n  return new Promise((resolve, reject) => {\r\n    return getRequestDetailApi(value)\r\n      .then((res) => {\r\n        if (res.data) {\r\n          dispatch(\r\n            setRequestDetail({\r\n              requestDetail: res.data.detail,\r\n              requestLogs: res.data.logs,\r\n            })\r\n          );\r\n        }\r\n        resolve();\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const onUpdateRequest = (value, requestId) => (dispatch) => {\r\n  return new Promise((resolve, reject) => {\r\n    dispatch(loading());\r\n    return updateRequestApi(value, requestId)\r\n      .then((res) => {\r\n        dispatch(getRequestDetail(requestId));\r\n        message.success(\"success\");\r\n        resolve();\r\n      })\r\n      .catch((error) => {\r\n        message.error(error.response.data.message);\r\n        reject(error);\r\n      })\r\n      .finally(() => {\r\n        dispatch(stopLoading());\r\n      });\r\n  });\r\n};\r\n\r\nexport const exportRequestByServer = (val) => (dispatch) => {\r\n  return new Promise((resolve, reject) => {\r\n    return exportRequestApi(val)\r\n      .then((res) => {\r\n        message.success(\"success\");\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        message.error(\"fail\");\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n","import axios from \"axios/auth.instance\";\r\n\r\nexport const getListRequestApi = (params = {}) => {\r\n  //   console.log(params);\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .get(\"/api/requests\", { params: params })\r\n      .then((res) => {\r\n        resolve(res.data);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const createRequestApi = (data) => {\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .post(\"/api/requests\", data)\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const getServerOptionsApi = () => {\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .get(\"/api/servers/active\")\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const approveRequestApi = (value) => {\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .put(\"/api/requests/approve-request\", value)\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const cancelRequestApi = (value) => {\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .put(\"/api/requests/cancel-request\", value)\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const updateRequestApi = (value, requestId) => {\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .put(`/api/requests/${requestId}`, value)\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const getRequestDetailApi = (value) => {\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .get(`/api/requests/${value}`)\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const getListUserOptionsApi = () => {\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .get(\"/api/users/listall\")\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const exportRequestApi = (val) => {\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .post(\"/api/requests/export-request\", val)\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const getAllMessageApi = (requestId) => {\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .get(`/api/messages/by-request/${requestId}`)\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport const getRepliedMsgApi = (msgId) => {\r\n  return new Promise((resolve, reject) => {\r\n    return axios\r\n      .get(`/api/messages/${msgId}`)\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n"],"sourceRoot":""}